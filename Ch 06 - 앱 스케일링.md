
# 쿠버네티스 스케일링 방법

**스케일링 시 각 리소스의 역할**
> **디플로이먼**
> + 레플리카셋 관리
> 
> **레플리카 셋**
> + 파드 관리
> 
> **파드**
> + 앱이 실행되는 컨테이너 관리
>   
> **레플리카**
> + 같은 앱이 실행되는 파드
>   
> **서비스**
> + 레이블 셀렉터와 일치하는 파드 수가 많으면, 적절하게 로드밸런싱
> + 모든 서비스는 기본적으로 로드밸런싱 기능 탑재

*ref.* [[쿠버네티스-Ch1.pdf#page=183]]
*ref.* [[쿠버네티스-Ch1.pdf#page=187]] →  서비스

## 스케일링 - 디플로이먼트

**특징**
> *1)* 디플로이먼트 레이블 셀렉터 → 파드 템플릿에 기재된 레이블과 일치
> *2)* 파드 업데이트 하는 경우
> + 대체 레플리카셋 생성 후 기존 레플리카셋의 레플리카 수를 0으로 변경
> + 다시 기존의 `yaml` 적용 시 → 기존 레플리카셋의 레플리카 수를 증가 시킨다.

*ref.* [[쿠버네티스-Ch1.pdf#page=190]] 

**디플로이먼트의 파드 정의 이름**
> 디플로이먼트의 파드 정의 템플릿 속 해시 값 이다.
> 따라서, 기존의 파드 정의를 활용한다면 기존의 레플리카셋을 활용할 수 있다.  
> 
> 이는**레플리카 수가 0인 레플리카셋이 여러 개 남아 있는 이유**이다.

*ref.* [[쿠버네티스-Ch1.pdf#page=195]] 


# 데몬셋을 이용한 스케일링

**데몬셋 정의**
> 노드에서 하나만 동작하는 파드이다.
> 따라서, 한 노드에 하나의 파드만 동작하는 상황이 필요한 경우 활용 가능하다. (nginx)

*ref.* [[쿠버네티스-Ch1.pdf#page=199]] 

**활용**
> *1)* 각 노드에서 하나만 존재 → 노드의 정보를 모아서 중앙에 전달 하는데 활용
> *2)* 인프라 수준의 관심사에 활용
> *3)* 호스트 경로 볼륨 사용 시
> + 공유 캐시로 부터 얻는 효과는 없지만
> + 같은 데이터 파일에 접근하는 인스턴스가 하나 이다.
> 
> *4)* 특정 노드에 레이블 지정 후 특정 노드에만 파드 실행 가능

*ref.* [[쿠버네티스-Ch1.pdf#page=200]] 

**특징**
> 디플로이먼트와 다르게 데몬 셋 삭제 시 파드가 그대로 남길 수 있다. `cascade`
> 이후 데몬셋 생성 시 파드 템플릿이 일치한다면 기존 파드와 다시 연결된다.

*ref.* [[쿠버네티스-Ch1.pdf#page=205]] 